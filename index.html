<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±èªå­¸ç¿’ç¸½éƒ¨ - English Learning HQ</title>
    
    <!-- å­—é«” -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&family=Noto+Serif+TC:wght@600;900&family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Import Map for Firebase -->
    <script type="importmap">
    {
        "imports": {
            "firebase/app": "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js",
            "firebase/auth": "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js",
            "firebase/firestore": "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js"
        }
    }
    </script>

    <style>
        :root {
            /* åŸºç¤é…è‰² */
            --bg: #f3f4f6;
            --text-main: #1f2937;
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Poppins', 'Noto Sans TC', sans-serif;
            background-color: var(--bg);
            background-image: 
                linear-gradient(rgba(200, 200, 200, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(200, 200, 200, 0.1) 1px, transparent 1px);
            background-size: 30px 30px;
            color: var(--text-main);
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .font-serif { font-family: 'Noto Serif TC', serif; }

        /* === 15 å¤§åˆ†é¡ä¸»é¡Œè‰²ç³»å®šç¾© (CSS Variables) === */
        /* å®šç¾©æ¯å€‹åˆ†é¡çš„ä¸»è‰² (--theme-c) èˆ‡èƒŒæ™¯è‰² (--theme-bg) */
        .theme-cat1 { --theme-c: #e60012; --theme-bg: #ffebee; } /* Gaming - Mario Red */
        .theme-cat2 { --theme-c: #00bcd4; --theme-bg: #e0f7fa; } /* Sci-Fi - Neon Cyan */
        .theme-cat3 { --theme-c: #7b1fa2; --theme-bg: #f3e5f5; } /* Horror - Deep Purple */
        .theme-cat4 { --theme-c: #ff6d00; --theme-bg: #fff3e0; } /* Sports - Energetic Orange */
        .theme-cat5 { --theme-c: #ec407a; --theme-bg: #fce4ec; } /* Pop Culture - Hot Pink */
        .theme-cat6 { --theme-c: #43a047; --theme-bg: #e8f5e9; } /* Nature - Grass Green */
        .theme-cat7 { --theme-c: #795548; --theme-bg: #efebe9; } /* History - Vintage Brown */
        .theme-cat8 { --theme-c: #455a64; --theme-bg: #eceff1; } /* Survival - Slate Grey */
        .theme-cat9 { --theme-c: #3f51b5; --theme-bg: #e8eaf6; } /* Teen Life - Indigo */
        .theme-cat10 { --theme-c: #fdd835; --theme-bg: #fffde7; } /* Laughs - Bright Yellow */
        .theme-cat11 { --theme-c: #2e7d32; --theme-bg: #e8f5e9; } /* Money - Dollar Green */
        .theme-cat12 { --theme-c: #006064; --theme-bg: #e0f2f1; } /* Geography - Deep Teal */
        .theme-cat13 { --theme-c: #37474f; --theme-bg: #cfd8dc; } /* Machines - Metal */
        .theme-cat14 { --theme-c: #d84315; --theme-bg: #fbe9e7; } /* Food - Burnt Orange */
        .theme-cat15 { --theme-c: #827717; --theme-bg: #f0f4c3; } /* Animals - Olive */

        /* å¡ç‰‡åŸºç¤æ¨£å¼ */
        .app-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 24px 20px;
            color: #333;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            
            /* é è¨­é‚Šæ¡† (æœªå®Œæˆæ™‚) */
            border-top: 6px solid #ccc; 
            border-left: 1px solid rgba(0,0,0,0.05);
            border-right: 1px solid rgba(0,0,0,0.05);
            border-bottom: 1px solid rgba(0,0,0,0.05);
            
            position: relative;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100%;
        }

        /* æ‡‰ç”¨ä¸»é¡Œè‰²åˆ°æœªå®Œæˆå¡ç‰‡çš„é ‚éƒ¨ */
        .theme-item { border-top-color: var(--theme-c); }
        .theme-item .card-icon { background: var(--theme-bg); color: var(--theme-c); }
        .theme-item .card-title { color: #374151; }
        .theme-item:hover .card-title { color: var(--theme-c); transition: color 0.3s; }

        .app-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        }

        /* === å·²å®Œæˆç‰¹æ•ˆ (å‹•æ…‹é¡è‰²) === */
        /* é‡é»ä¿®æ”¹ï¼šä½¿ç”¨ var(--theme-c) è®“è¢å…‰é‚Šæ¡†è·Ÿéš¨è©² Category çš„é¡è‰² */
        .app-card.completed {
            border: 3px solid var(--theme-c) !important;
            border-top: 6px solid var(--theme-c) !important;
            /* è¢å…‰å…‰æšˆæ•ˆæœ */
            box-shadow: 0 0 15px var(--theme-c) !important; 
            transform: scale(1.02);
            /* èƒŒæ™¯å¾®å¾®é€å‡ºè©²ä¸»é¡Œè‰² */
            background-color: var(--theme-bg);
            z-index: 10;
        }

        .app-card.completed .card-badge {
            background: var(--theme-c) !important;
            color: #fff;
        }

        .app-card.completed .card-icon {
            background: #fff !important;
            color: var(--theme-c) !important;
            border: 2px solid var(--theme-c);
        }

        /* åœ–ç¤ºå®¹å™¨ */
        .card-icon {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.2em;
            margin-bottom: 16px;
            transition: all 0.3s;
        }

        /* åˆ†éš”ç·š */
        .divider {
            display: flex;
            align-items: center;
            margin: 50px 0 30px 0;
            color: #374151;
            font-family: 'Poppins', sans-serif;
            font-size: 1.8em;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .divider::before, .divider::after {
            content: "";
            flex: 1;
            border-bottom: 3px solid #e5e7eb;
        }
        .divider::before { margin-right: 20px; }
        .divider::after { margin-left: 20px; }
        
        /* æ¯å€‹ Category æ¨™é¡Œä¹Ÿå¥—ç”¨ä¸»é¡Œè‰² */
        .cat-title-1 { color: #e60012; }
        .cat-title-2 { color: #00bcd4; }
        .cat-title-3 { color: #7b1fa2; }
        .cat-title-4 { color: #ff6d00; }
        .cat-title-5 { color: #ec407a; }
        .cat-title-6 { color: #43a047; }
        .cat-title-7 { color: #795548; }
        .cat-title-8 { color: #455a64; }
        .cat-title-9 { color: #3f51b5; }
        .cat-title-10 { color: #fbc02d; } /* Darker yellow for text visibility */
        .cat-title-11 { color: #2e7d32; }
        .cat-title-12 { color: #006064; }
        .cat-title-13 { color: #37474f; }
        .cat-title-14 { color: #d84315; }
        .cat-title-15 { color: #827717; }

        /* ç‹€æ…‹ç‡ˆè™Ÿ */
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 6px;
        }
        .status-loading { background-color: #fdd835; }
        .status-success { background-color: #4caf50; }
        .status-error { background-color: #ef5350; }
        .status-offline { background-color: #9e9e9e; }

        /* æ ¸å–æ–¹å¡Šæ¨£å¼ */
        .check-circle {
            width: 26px;
            height: 26px;
            border-radius: 50%;
            border: 2px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            background: white;
        }
        .app-card:hover .check-circle { border-color: #bbb; }
        .app-card.completed .check-circle {
            background: var(--theme-c);
            border-color: var(--theme-c);
            color: white;
        }

        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 4px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import { initializeApp } from "firebase/app";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, signOut } from "firebase/auth";
        import { getFirestore, doc, setDoc, getDoc, onSnapshot, collection, updateDoc, arrayUnion } from "firebase/firestore";
        
        const { useState, useEffect } = React;

        /* ================= è³‡æ–™å®šç¾© (150 Items) ================= */
        const ALL_CATEGORIES = [
            {
                title: "1. Gaming & Esports",
                theme: "theme-cat1",
                textClass: "cat-title-1",
                items: [
                    { id: "E1", title: "The History of Mario", subtitle: "ç‘ªåˆ©æ­çš„é€²åŒ–å²", file: "English-Reading-1.html", icon: "ğŸ„" },
                    { id: "E2", title: "How to Go Pro", subtitle: "å¦‚ä½•æˆç‚ºè·æ¥­é›»ç«¶é¸æ‰‹ï¼Ÿ", file: "English-Reading-2.html", icon: "ğŸ®" },
                    { id: "E3", title: "Minecraft World", subtitle: "éº¥å¡Šï¼šæ‰“é€ è™›æ“¬ä¸–ç•Œ", file: "English-Reading-3.html", icon: "â›ï¸" },
                    { id: "E4", title: "Most Expensive Items", subtitle: "å²ä¸Šè³£æœ€è²´çš„è™›æ“¬å¯¶ç‰©", file: "English-Reading-4.html", icon: "ğŸ’" },
                    { id: "E5", title: "Why Do We Rage Quit?", subtitle: "ç‚ºä»€éº¼ç©éŠæˆ²æœƒçˆ†æ°£ï¼Ÿ", file: "English-Reading-5.html", icon: "ğŸ˜¡" },
                    { id: "E6", title: "Top 5 Cheat Codes", subtitle: "éŠæˆ²å²ä¸Šæœ€å¼·çš„ 5 å€‹ä½œå¼Šç¢¼", file: "English-Reading-6.html", icon: "âŒ¨ï¸" },
                    { id: "E7", title: "VR Gaming Future", subtitle: "VR éŠæˆ²ï¼šæœªä¾†é‚„æ˜¯æ›‡èŠ±ä¸€ç¾ï¼Ÿ", file: "English-Reading-7.html", icon: "ğŸ¥½" },
                    { id: "E8", title: "Story of LoL", subtitle: "è‹±é›„è¯ç›ŸèƒŒå¾Œçš„æ•…äº‹", file: "English-Reading-8.html", icon: "ğŸ†" },
                    { id: "E9", title: "Glitches as Features", subtitle: "è®ŠæˆéŠæˆ²ç‰¹è‰²çš„ Bug", file: "English-Reading-9.html", icon: "ğŸ‘¾" },
                    { id: "E10", title: "Addictive Design", subtitle: "éŠæˆ²é–‹ç™¼è€…å¦‚ä½•è®“ä½ ä¸Šç™®", file: "English-Reading-10.html", icon: "ğŸ§ " }
                ]
            },
            {
                title: "2. Sci-Fi, Tech & AI",
                theme: "theme-cat2",
                textClass: "cat-title-2",
                items: [
                    { id: "E11", title: "AI and Your Job", subtitle: "AI æœƒæ¶èµ°ä½ æœªä¾†çš„å·¥ä½œå—ï¼Ÿ", file: "English-Reading-11.html", icon: "ğŸ¤–" },
                    { id: "E12", title: "Living on Mars", subtitle: "ç«æ˜Ÿç§»æ°‘ï¼šé¦¬æ–¯å…‹çš„å¤¢æƒ³", file: "English-Reading-12.html", icon: "ğŸš€" },
                    { id: "E13", title: "The Dark Web", subtitle: "æš—ç¶²æ˜¯ä»€éº¼ï¼Ÿ", file: "English-Reading-13.html", icon: "ğŸ•µï¸" },
                    { id: "E14", title: "Flying Cars", subtitle: "é£›å¤©è»Šé›¢æˆ‘å€‘é‚„æœ‰å¤šé ï¼Ÿ", file: "English-Reading-14.html", icon: "ğŸ›¸" },
                    { id: "E15", title: "Password Theft", subtitle: "é§­å®¢å¦‚ä½•å·èµ°ä½ çš„å¯†ç¢¼", file: "English-Reading-15.html", icon: "ğŸ”" },
                    { id: "E16", title: "Time Travel", subtitle: "æ™‚å…‰æ—…è¡ŒçœŸçš„å¯è¡Œå—ï¼Ÿ", file: "English-Reading-16.html", icon: "â³" },
                    { id: "E17", title: "Black Holes", subtitle: "é»‘æ´çš„ç§‘å­¸", file: "English-Reading-17.html", icon: "ğŸ•³ï¸" },
                    { id: "E18", title: "Robots with Pain", subtitle: "æœƒæœ‰ç—›è¦ºçš„æ©Ÿå™¨äºº", file: "English-Reading-18.html", icon: "ğŸ¦¾" },
                    { id: "E19", title: "5 Cool Gadgets", subtitle: "5 å€‹ä½ è¶…æƒ³æ“æœ‰çš„é»‘ç§‘æŠ€å°ç‰©", file: "English-Reading-19.html", icon: "âŒš" },
                    { id: "E20", title: "ChatGPT", subtitle: "æ˜¯æœ‹å‹é‚„æ˜¯æ•µäººï¼Ÿ", file: "English-Reading-20.html", icon: "ğŸ’¬" }
                ]
            },
            {
                title: "3. Mystery & Urban Legends",
                theme: "theme-cat3",
                textClass: "cat-title-3",
                items: [
                    { id: "E21", title: "Bermuda Triangle", subtitle: "ç™¾æ…•é”ä¸‰è§’æ´²ä¹‹è¬", file: "English-Reading-21.html", icon: "ğŸ“" },
                    { id: "E22", title: "Real-Life Zombies", subtitle: "è‡ªç„¶ç•ŒçœŸå¯¦å­˜åœ¨çš„æ®­å±ç”Ÿç‰©", file: "English-Reading-22.html", icon: "ğŸ§Ÿ" },
                    { id: "E23", title: "Legend of Kraken", subtitle: "åŒ—æ­æµ·æ€ªï¼šæ·±æµ·å·¨ç¸", file: "English-Reading-23.html", icon: "ğŸ¦‘" },
                    { id: "E24", title: "Japanese Legends", subtitle: "5 å€‹æœ€æ¯›çš„æ—¥æœ¬éƒ½å¸‚å‚³èªª", file: "English-Reading-24.html", icon: "ğŸ‘»" },
                    { id: "E25", title: "Dyatlov Pass", subtitle: "é›ªå±±é›¢å¥‡æ­»äº¡ä¹‹è¬", file: "English-Reading-25.html", icon: "ğŸ”ï¸" },
                    { id: "E26", title: "Area 51 Secrets", subtitle: "å¤–æ˜Ÿäººå­˜åœ¨å—ï¼Ÿ51 å€çš„ç§˜å¯†", file: "English-Reading-26.html", icon: "ğŸ‘½" },
                    { id: "E27", title: "Pharaohs' Curse", subtitle: "æ³•è€çš„è©›å’’", file: "English-Reading-27.html", icon: "âš°ï¸" },
                    { id: "E28", title: "Sleep Paralysis", subtitle: "é¬¼å£“åºŠï¼šæˆ¿é–“è£¡çš„æƒ¡é­”ï¼Ÿ", file: "English-Reading-28.html", icon: "ğŸ›Œ" },
                    { id: "E29", title: "Nazca Lines", subtitle: "ç´æ–¯å¡ç·šï¼šçµ¦å¤–æ˜Ÿäººçœ‹çš„ç•«ï¼Ÿ", file: "English-Reading-29.html", icon: "ğŸœï¸" },
                    { id: "E30", title: "Hope Diamond", subtitle: "å¸Œæœ›é‘½çŸ³çš„è©›å’’", file: "English-Reading-30.html", icon: "ğŸ’" }
                ]
            },
            {
                title: "4. Sports & Extreme",
                theme: "theme-cat4",
                textClass: "cat-title-4",
                items: [
                    { id: "E31", title: "Mamba Mentality", subtitle: "æ›¼å·´ç²¾ç¥ï¼šKobe Bryant", file: "English-Reading-31.html", icon: "ğŸ€" },
                    { id: "E32", title: "Why AJ is Expensive", subtitle: "ç‚ºä»€éº¼ AJ é‹é€™éº¼è²´ï¼Ÿ", file: "English-Reading-32.html", icon: "ğŸ‘Ÿ" },
                    { id: "E33", title: "Parkour", subtitle: "è·‘é…·ï¼šç§»å‹•çš„è—è¡“", file: "English-Reading-33.html", icon: "ğŸƒ" },
                    { id: "E34", title: "Usain Bolt", subtitle: "åœ°è¡¨æœ€é€Ÿç”·", file: "English-Reading-34.html", icon: "âš¡" },
                    { id: "E35", title: "Rise of UFC", subtitle: "UFC çš„å´›èµ·ï¼šç¶œåˆæ ¼é¬¥", file: "English-Reading-35.html", icon: "ğŸ¥Š" },
                    { id: "E36", title: "F1 Racing", subtitle: "F1 è³½è»Šï¼šé€Ÿåº¦èˆ‡ç§‘å­¸", file: "English-Reading-36.html", icon: "ğŸï¸" },
                    { id: "E37", title: "Brain Training", subtitle: "é ‚å°–é‹å‹•å“¡å¦‚ä½•è¨“ç·´å¤§è…¦", file: "English-Reading-37.html", icon: "ğŸ§ " },
                    { id: "E38", title: "Dangerous Sports", subtitle: "ä¸–ç•Œä¸Šæœ€å±éšªçš„é‹å‹•", file: "English-Reading-38.html", icon: "ğŸ§—" },
                    { id: "E39", title: "Sneaker Culture", subtitle: "çƒé‹æ–‡åŒ–ï¼šç‚’é‹è³ºéŒ¢ï¼Ÿ", file: "English-Reading-39.html", icon: "ğŸ‘Ÿ" },
                    { id: "E40", title: "Messi vs. Ronaldo", subtitle: "èª°æ˜¯å²ä¸Šæœ€ä½³ï¼Ÿ", file: "English-Reading-40.html", icon: "âš½" }
                ]
            },
            {
                title: "5. Movies & Pop Culture",
                theme: "theme-cat5",
                textClass: "cat-title-5",
                items: [
                    { id: "E41", title: "Why Capes?", subtitle: "ç‚ºä»€éº¼è¶…ç´šè‹±é›„è¦ç©¿æŠ«é¢¨ï¼Ÿ", file: "English-Reading-41.html", icon: "ğŸ¦¸" },
                    { id: "E42", title: "Naruto's Way", subtitle: "ç«å½±å¿è€…çš„å“²å­¸", file: "English-Reading-42.html", icon: "ğŸ¥" },
                    { id: "E43", title: "Godzilla", subtitle: "å“¥å‰æ‹‰ï¼šæ€ªç¸é‚„æ˜¯è‹±é›„ï¼Ÿ", file: "English-Reading-43.html", icon: "ğŸ¦–" },
                    { id: "E44", title: "Special Effects", subtitle: "é›»å½±ç‰¹æ•ˆæ˜¯æ€éº¼åšå‡ºä¾†çš„ï¼Ÿ", file: "English-Reading-44.html", icon: "ğŸ¬" },
                    { id: "E45", title: "Marvel vs. DC", subtitle: "çµ‚æ¥µå°æ±º", file: "English-Reading-45.html", icon: "ğŸ’¥" },
                    { id: "E46", title: "Studio Ghibli", subtitle: "å‰åœåŠ›å·¥ä½œå®¤ï¼šå‹•ç•«çš„é­”æ³•", file: "English-Reading-46.html", icon: "ğŸ" },
                    { id: "E47", title: "One Piece", subtitle: "ç‚ºä»€éº¼èˆªæµ·ç‹æ˜¯ç¬¬ä¸€åï¼Ÿ", file: "English-Reading-47.html", icon: "â˜ ï¸" },
                    { id: "E48", title: "MillionaireTubers", subtitle: "è®Šæˆç™¾è¬å¯Œç¿çš„ YouTuber", file: "English-Reading-48.html", icon: "ğŸ’°" },
                    { id: "E49", title: "K-Pop Phenomenon", subtitle: "K-Pop å¦‚ä½•å¸­æ²å…¨çƒ", file: "English-Reading-49.html", icon: "ğŸ¤" },
                    { id: "E50", title: "Meme Culture", subtitle: "è¿·å› ï¼šç¶²è·¯çš„èªè¨€", file: "English-Reading-50.html", icon: "ğŸ˜¹" }
                ]
            },
            {
                title: "6. Strange Nature",
                theme: "theme-cat6",
                textClass: "cat-title-6",
                items: [
                    { id: "E51", title: "Deadly Animals", subtitle: "å¹¾ç§’é˜å°±èƒ½æ®ºæ­»ä½ çš„å‹•ç‰©", file: "English-Reading-51.html", icon: "ğŸ¦‚" },
                    { id: "E52", title: "Immortal Jellyfish", subtitle: "æ°¸ç”Ÿä¸æ­»çš„ç‡ˆå¡”æ°´æ¯", file: "English-Reading-52.html", icon: "ğŸª¼" },
                    { id: "E53", title: "Why Cats Purr", subtitle: "è²“å’ªç‚ºä»€éº¼æœƒå‘¼åš•ï¼Ÿ", file: "English-Reading-53.html", icon: "ğŸ±" },
                    { id: "E54", title: "Meat-Eating Plants", subtitle: "é£Ÿè‚‰æ¤ç‰©", file: "English-Reading-54.html", icon: "ğŸª´" },
                    { id: "E55", title: "The Bloop", subtitle: "ä¾†è‡ªæ·±æµ·çš„ç¥ç§˜æ€ªè²", file: "English-Reading-55.html", icon: "ğŸŒŠ" },
                    { id: "E56", title: "Cockroaches", subtitle: "èŸ‘è‚çœŸçš„èƒ½æŒºéæ ¸çˆ†å—ï¼Ÿ", file: "English-Reading-56.html", icon: "ğŸª³" },
                    { id: "E57", title: "Megalodon", subtitle: "å·¨é½’é¯Šï¼šé‚„æ´»è‘—å—ï¼Ÿ", file: "English-Reading-57.html", icon: "ğŸ¦ˆ" },
                    { id: "E58", title: "Nightmares", subtitle: "æˆ‘å€‘ç‚ºä»€éº¼æœƒåšæƒ¡å¤¢ï¼Ÿ", file: "English-Reading-58.html", icon: "ğŸ’¤" },
                    { id: "E59", title: "Telepathy", subtitle: "å¿ƒé›»æ„Ÿæ‡‰æ˜¯æœ‰å¯èƒ½çš„å—ï¼Ÿ", file: "English-Reading-59.html", icon: "ğŸ”®" },
                    { id: "E60", title: "True But Fake", subtitle: "10 å€‹è½èµ·ä¾†åƒå‡çš„ä½†å»æ˜¯çœŸçš„", file: "English-Reading-60.html", icon: "ğŸ¤¥" }
                ]
            },
            {
                title: "7. History & Weapons",
                theme: "theme-cat7",
                textClass: "cat-title-7",
                items: [
                    { id: "E61", title: "Samurai vs. Knights", subtitle: "æ­¦å£« vs é¨å£«ï¼šèª°æœƒè´ï¼Ÿ", file: "English-Reading-61.html", icon: "âš”ï¸" },
                    { id: "E62", title: "Ninjas", subtitle: "å¿è€…çš„ç§˜å¯†ç”Ÿæ´»", file: "English-Reading-62.html", icon: "ğŸ¥·" },
                    { id: "E63", title: "Snipers", subtitle: "ç‹™æ“Šæ‰‹ï¼šéš±å½¢å£«å…µ", file: "English-Reading-63.html", icon: "ğŸ¯" },
                    { id: "E64", title: "Trojan Horse", subtitle: "ç‰¹æ´›ä¼Šæœ¨é¦¬ï¼šå¤©æ‰çš„è©­è¨ˆ", file: "English-Reading-64.html", icon: "ğŸ´" },
                    { id: "E65", title: "Tanks", subtitle: "å¦å…‹ï¼šæˆ°å ´å·¨ç¸", file: "English-Reading-65.html", icon: "ğŸ›¡ï¸" },
                    { id: "E66", title: "Genghis Khan", subtitle: "æˆå‰æ€æ±—ï¼šè’™å¤å¸åœ‹", file: "English-Reading-66.html", icon: "ğŸ°" },
                    { id: "E67", title: "Real Pirates", subtitle: "çœŸå¯¦çš„ç¥é¬¼å¥‡èˆªæµ·ç›œ", file: "English-Reading-67.html", icon: "ğŸ´â€â˜ ï¸" },
                    { id: "E68", title: "Vikings", subtitle: "ç¶­äº¬äººï¼šæ å¥ªè€…é‚„æ˜¯è²¿æ˜“å•†ï¼Ÿ", file: "English-Reading-68.html", icon: "â›µ" },
                    { id: "E69", title: "WWII Spies", subtitle: "äºŒæˆ°ä¸­çš„å¯†ç¢¼èˆ‡é–“è«œ", file: "English-Reading-69.html", icon: "ğŸ“»" },
                    { id: "E70", title: "Ancient Weapons", subtitle: "è¶…è¶Šæ™‚ä»£çš„å¤ä»£å…µå™¨", file: "English-Reading-70.html", icon: "ğŸ—¡ï¸" }
                ]
            },
            {
                title: "8. Survival & Adventure",
                theme: "theme-cat8",
                textClass: "cat-title-8",
                items: [
                    { id: "E71", title: "Shark Attack", subtitle: "é­é‡é¯Šé­šæ”»æ“Šè©²æ€éº¼è¾¦ï¼Ÿ", file: "English-Reading-71.html", icon: "ğŸ¦ˆ" },
                    { id: "E72", title: "Amazon Jungle", subtitle: "è¿·å¤±åœ¨äºé¦¬éœå¢æ—", file: "English-Reading-72.html", icon: "ğŸŒ³" },
                    { id: "E73", title: "Mount Everest", subtitle: "æ”€ç™»è–æ¯å³°ï¼šæ­»äº¡åœ°å¸¶", file: "English-Reading-73.html", icon: "ğŸ”ï¸" },
                    { id: "E74", title: "Bear Grylls", subtitle: "è²çˆ¾ï¼šä»€éº¼éƒ½åƒçš„ç”·äºº", file: "English-Reading-74.html", icon: "ğŸ›" },
                    { id: "E75", title: "Desert Island", subtitle: "è’å³¶æ±‚ç”ŸæŒ‡å—", file: "English-Reading-75.html", icon: "ğŸï¸" },
                    { id: "E76", title: "Deep Sea", subtitle: "æ·±æµ·æ¢éšªï¼šæœ€å¾Œçš„é‚Šç–†", file: "English-Reading-76.html", icon: "âš“" },
                    { id: "E77", title: "Bear Encounter", subtitle: "é‡åˆ°ç†Šè©²æ€éº¼è¾¦ï¼Ÿ", file: "English-Reading-77.html", icon: "ğŸ»" },
                    { id: "E78", title: "Urban Exploration", subtitle: "åŸå¸‚å»¢å¢Ÿæ¢éšªï¼šé¢¨éšªèˆ‡å›å ±", file: "English-Reading-78.html", icon: "ğŸ­" },
                    { id: "E79", title: "Solo Travel at 16", subtitle: "16 æ­²ç¨è‡ªç’°éŠä¸–ç•Œ", file: "English-Reading-79.html", icon: "ğŸ’" },
                    { id: "E80", title: "Van Life", subtitle: "è»Šå®¿ç”Ÿæ´»ï¼šä½åœ¨è·¯ä¸Š", file: "English-Reading-80.html", icon: "ğŸš" }
                ]
            },
            {
                title: "9. Teen Life & School",
                theme: "theme-cat9",
                textClass: "cat-title-9",
                items: [
                    { id: "E81", title: "Dealing with Bullies", subtitle: "å¦‚ä½•æ‡‰å°éœ¸å‡Œ", file: "English-Reading-81.html", icon: "ğŸ›‘" },
                    { id: "E82", title: "Procrastination", subtitle: "æ‹–å»¶ç—‡çš„ç§‘å­¸", file: "English-Reading-82.html", icon: "ğŸŒ" },
                    { id: "E83", title: "Talk to Anyone", subtitle: "å¦‚ä½•è·Ÿä»»ä½•äººèŠå¤©", file: "English-Reading-83.html", icon: "ğŸ—£ï¸" },
                    { id: "E84", title: "Understanding Parents", subtitle: "ç‚ºä»€éº¼çˆ¶æ¯éƒ½ä¸æ‡‚æˆ‘å€‘ï¼Ÿ", file: "English-Reading-84.html", icon: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦" },
                    { id: "E85", title: "Exam Stress", subtitle: "è€ƒè©¦å£“åŠ›ï¼šå¦‚ä½•æ“Šæ•—å®ƒ", file: "English-Reading-85.html", icon: "ğŸ“" },
                    { id: "E86", title: "Introverts vs Extroverts", subtitle: "å…§å‘è€… vs å¤–å‘è€…", file: "English-Reading-86.html", icon: "ğŸ”‹" },
                    { id: "E87", title: "Saying No", subtitle: "æ‹’çµ•çš„è—è¡“", file: "English-Reading-87.html", icon: "ğŸ™…" },
                    { id: "E88", title: "Music & Study", subtitle: "è½éŸ³æ¨‚çœŸçš„æœ‰åŠ©æ–¼è®€æ›¸å—ï¼Ÿ", file: "English-Reading-88.html", icon: "ğŸ§" },
                    { id: "E89", title: "First Dates", subtitle: "åˆæ¬¡ç´„æœƒï¼šDo's and Don'ts", file: "English-Reading-89.html", icon: "ğŸ’˜" },
                    { id: "E90", title: "Building Confidence", subtitle: "å»ºç«‹è‡ªä¿¡ï¼šå‡è£ä¹…äº†å°±æ˜¯çœŸçš„", file: "English-Reading-90.html", icon: "ğŸ¦" }
                ]
            },
            {
                title: "10. Just for Laughs",
                theme: "theme-cat10",
                textClass: "cat-title-10",
                items: [
                    { id: "E91", title: "Dumbest Criminals", subtitle: "ä¸–ç•Œä¸Šæœ€ç¬¨çš„ç½ªçŠ¯", file: "English-Reading-91.html", icon: "ğŸš“" },
                    { id: "E92", title: "Open Bottle Trick", subtitle: "æ²’æœ‰é–‹ç“¶å™¨æ€éº¼é–‹ç“¶å­", file: "English-Reading-92.html", icon: "ğŸ¾" },
                    { id: "E93", title: "Lazy Hacks", subtitle: "æ‡¶æƒ°å­¸ç”Ÿçš„ç”Ÿæ´»é§­å®¢æŠ€å·§", file: "English-Reading-93.html", icon: "ğŸ›Œ" },
                    { id: "E94", title: "History of Pizza", subtitle: "æŠ«è–©çš„æ­·å²", file: "English-Reading-94.html", icon: "ğŸ•" },
                    { id: "E95", title: "Weird Laws", subtitle: "ä¸–ç•Œå„åœ°çš„æ€ªç•°æ³•å¾‹", file: "English-Reading-95.html", icon: "âš–ï¸" },
                    { id: "E96", title: "Tie a Tie", subtitle: "å¦‚ä½•æ‰“é ˜å¸¶ (Step by Step)", file: "English-Reading-96.html", icon: "ğŸ‘”" },
                    { id: "E97", title: "Why We Yawn", subtitle: "æˆ‘å€‘ç‚ºä»€éº¼æœƒæ‰“å“ˆæ¬ ï¼Ÿ", file: "English-Reading-97.html", icon: "ğŸ¥±" },
                    { id: "E98", title: "Optical Illusions", subtitle: "æ¬ºé¨™å¤§è…¦çš„è¦–éŒ¯è¦º", file: "English-Reading-98.html", icon: "ğŸŒ€" },
                    { id: "E99", title: "Most Boring Job", subtitle: "ä¸–ç•Œä¸Šæœ€ç„¡èŠçš„å·¥ä½œ", file: "English-Reading-99.html", icon: "ğŸ˜" },
                    { id: "E100", title: "To My 13-Year-Old Self", subtitle: "çµ¦ 13 æ­²è‡ªå·±çš„å»ºè­°", file: "English-Reading-100.html", icon: "ğŸ’Œ" }
                ]
            },
            {
                title: "11. Money & Hustle",
                theme: "theme-cat11",
                textClass: "cat-title-11",
                items: [
                    { id: "E101", title: "YouTuber Earnings", subtitle: "YouTuber æ€éº¼è³ºéŒ¢çš„ï¼Ÿ", file: "English-Reading-101.html", icon: "ğŸ’¸" },
                    { id: "E102", title: "Cryptocurrency", subtitle: "ç°¡å–®ææ‡‚æ¯”ç‰¹å¹£", file: "English-Reading-102.html", icon: "ğŸª™" },
                    { id: "E103", title: "Story of Nike", subtitle: "Nike çš„å“ç‰Œå‚³å¥‡", file: "English-Reading-103.html", icon: "âœ”ï¸" },
                    { id: "E104", title: "Saving Money", subtitle: "é’å°‘å¹´å­˜éŒ¢æ”»ç•¥", file: "English-Reading-104.html", icon: "ğŸ–" },
                    { id: "E105", title: "Expensive NFT", subtitle: "å²ä¸Šæœ€è²´çš„ NFT", file: "English-Reading-105.html", icon: "ğŸ–¼ï¸" },
                    { id: "E106", title: "Elon Musk", subtitle: "ä¼Šéš†Â·é¦¬æ–¯å…‹çš„å•†æ¥­å¸åœ‹", file: "English-Reading-106.html", icon: "ğŸš€" },
                    { id: "E107", title: "Stock Market", subtitle: "è‚¡å¸‚æ˜¯ä»€éº¼ï¼Ÿ", file: "English-Reading-107.html", icon: "ğŸ“ˆ" },
                    { id: "E108", title: "Side Hustles", subtitle: "å­¸ç”Ÿå¯ä»¥åšçš„å‰¯æ¥­", file: "English-Reading-108.html", icon: "ğŸ’¼" },
                    { id: "E109", title: "iPhone Price", subtitle: "ç‚ºä»€éº¼ iPhone é€™éº¼è²´ï¼Ÿ", file: "English-Reading-109.html", icon: "ğŸ“±" },
                    { id: "E110", title: "Rich Dad Poor Dad", subtitle: "æ ¸å¿ƒè§€å¿µ", file: "English-Reading-110.html", icon: "ğŸ“˜" }
                ]
            },
            {
                title: "12. Extreme Geography",
                theme: "theme-cat12",
                textClass: "cat-title-12",
                items: [
                    { id: "E111", title: "Dangerous Road", subtitle: "æœ€å±éšªçš„å…¬è·¯ï¼šåŒ—æ°¸åŠ æ–¯è·¯", file: "English-Reading-111.html", icon: "ğŸ›£ï¸" },
                    { id: "E112", title: "Snake Island", subtitle: "è›‡å³¶ï¼šäººé¡ç¦åœ°", file: "English-Reading-112.html", icon: "ğŸ" },
                    { id: "E113", title: "Door to Hell", subtitle: "åœ°ç„ä¹‹é–€ï¼šç‡ƒç‡’çš„å¤§å‘", file: "English-Reading-113.html", icon: "ğŸ”¥" },
                    { id: "E114", title: "Point Nemo", subtitle: "åœ°çƒä¸Šæœ€å­¤ç¨çš„åœ°æ–¹", file: "English-Reading-114.html", icon: "ğŸŒŠ" },
                    { id: "E115", title: "Antarctica Desert", subtitle: "ç‚ºä»€éº¼å—æ¥µå…¶å¯¦æ˜¯æ²™æ¼ ï¼Ÿ", file: "English-Reading-115.html", icon: "â„ï¸" },
                    { id: "E116", title: "Mariana Trench", subtitle: "é¦¬é‡Œäºç´æµ·æºï¼šä¸–ç•Œçš„åº•ç«¯", file: "English-Reading-116.html", icon: "âš“" },
                    { id: "E117", title: "Dead Sea", subtitle: "æ­»æµ·æ­£åœ¨æ­»å»ï¼Ÿ", file: "English-Reading-117.html", icon: "ğŸŠ" },
                    { id: "E118", title: "Mount Thor", subtitle: "åœ°çƒä¸Šæœ€å¤§çš„å‚ç›´è½å·®", file: "English-Reading-118.html", icon: "â›°ï¸" },
                    { id: "E119", title: "Blood Falls", subtitle: "å—æ¥µçš„ç¥ç§˜ç´…æµ", file: "English-Reading-119.html", icon: "ğŸ©¸" },
                    { id: "E120", title: "Atlantis", subtitle: "å°‹æ‰¾å¤±è½ä¹‹åŸ", file: "English-Reading-120.html", icon: "ğŸ›ï¸" }
                ]
            },
            {
                title: "13. Vehicles & Speed",
                theme: "theme-cat13",
                textClass: "cat-title-13",
                items: [
                    { id: "E121", title: "Bugatti Chiron", subtitle: "å·¥ç¨‹å¥‡è¹Ÿ", file: "English-Reading-121.html", icon: "ğŸï¸" },
                    { id: "E122", title: "Jet Engines", subtitle: "å™´å°„å¼•æ“æ˜¯å¦‚ä½•é‹ä½œçš„ï¼Ÿ", file: "English-Reading-122.html", icon: "âœˆï¸" },
                    { id: "E123", title: "Ferrari vs Lambo", subtitle: "å®¿æ•µçš„æ•…äº‹", file: "English-Reading-123.html", icon: "ğŸ" },
                    { id: "E124", title: "Self-Driving Cars", subtitle: "å®‰å…¨é‚„æ˜¯ææ€–ï¼Ÿ", file: "English-Reading-124.html", icon: "ğŸš˜" },
                    { id: "E125", title: "Drifting", subtitle: "ç”©å°¾ï¼šæ»‘è¡Œçš„è—è¡“", file: "English-Reading-125.html", icon: "ğŸ’¨" },
                    { id: "E126", title: "Superyachts", subtitle: "æµ·ä¸Šçš„ç§»å‹•çš‡å®®", file: "English-Reading-126.html", icon: "ğŸ›¥ï¸" },
                    { id: "E127", title: "The Concorde", subtitle: "è¶…éŸ³é€Ÿå®¢æ©Ÿçš„å‚³å¥‡", file: "English-Reading-127.html", icon: "ğŸ›«" },
                    { id: "E128", title: "Monster Trucks", subtitle: "å¤§è¼ªå­çš„ç ´å£åŠ›", file: "English-Reading-128.html", icon: "ğŸ›" },
                    { id: "E129", title: "Maglev Trains", subtitle: "ç£æµ®åˆ—è»Šç‚ºä»€éº¼æœƒæ¼‚æµ®ï¼Ÿ", file: "English-Reading-129.html", icon: "ğŸš…" },
                    { id: "E130", title: "Top Gun Jets", subtitle: "çœŸå¯¦çš„æˆ°é¬¥æ©Ÿ", file: "English-Reading-130.html", icon: "ğŸ›©ï¸" }
                ]
            },
            {
                title: "14. Food Science",
                theme: "theme-cat14",
                textClass: "cat-title-14",
                items: [
                    { id: "E131", title: "Hottest Pepper", subtitle: "ä¸–ç•Œä¸Šæœ€è¾£çš„è¾£æ¤’", file: "English-Reading-131.html", icon: "ğŸŒ¶ï¸" },
                    { id: "E132", title: "Durian Smell", subtitle: "æ¦´æ§¤èèµ·ä¾†é€™éº¼è‡­ï¼Ÿ", file: "English-Reading-132.html", icon: "ğŸ¤¢" },
                    { id: "E133", title: "Space Food", subtitle: "å¤ªç©ºäººåˆ°åº•åƒä»€éº¼ï¼Ÿ", file: "English-Reading-133.html", icon: "ğŸ‘¨â€ğŸš€" },
                    { id: "E134", title: "Fast Food Secrets", subtitle: "é€Ÿé£Ÿåº—ä¸å‘Šè¨´ä½ çš„ç§˜å¯†", file: "English-Reading-134.html", icon: "ğŸ”" },
                    { id: "E135", title: "Eating Insects", subtitle: "äººé¡æœªä¾†çš„é£Ÿç‰©ä¾†æºï¼Ÿ", file: "English-Reading-135.html", icon: "ğŸ¦—" },
                    { id: "E136", title: "Brain Freeze", subtitle: "åƒå†°ç‚ºä»€éº¼æœƒé ­ç—›ï¼Ÿ", file: "English-Reading-136.html", icon: "ğŸ§" },
                    { id: "E137", title: "Expensive Pizza", subtitle: "ä¸–ç•Œä¸Šæœ€è²´çš„æŠ«è–©", file: "English-Reading-137.html", icon: "ğŸ•" },
                    { id: "E138", title: "Coffee Fuel", subtitle: "å’–å•¡ï¼šç¾ä»£ä¸–ç•Œçš„ç‡ƒæ–™", file: "English-Reading-138.html", icon: "â˜•" },
                    { id: "E139", title: "Cola Wars", subtitle: "å¯å£å¯æ¨‚ vs ç™¾äº‹å¯æ¨‚", file: "English-Reading-139.html", icon: "ğŸ¥¤" },
                    { id: "E140", title: "Onion Tears", subtitle: "ç‚ºä»€éº¼åˆ‡æ´‹è”¥æœƒæµæ·šï¼Ÿ", file: "English-Reading-140.html", icon: "ğŸ§…" }
                ]
            },
            {
                title: "15. Savage Wildlife",
                theme: "theme-cat15",
                textClass: "cat-title-15",
                items: [
                    { id: "E141", title: "Titanoboa", subtitle: "å²ä¸Šæœ€å¤§çš„è›‡", file: "English-Reading-141.html", icon: "ğŸ" },
                    { id: "E142", title: "Deadly Hippos", subtitle: "æ²³é¦¬ï¼šå¯æ„›ä½†è‡´å‘½", file: "English-Reading-142.html", icon: "ğŸ¦›" },
                    { id: "E143", title: "Mantis Shrimp", subtitle: "é›€å°¾è³è‚è¦ï¼šè¶…å¼·æ‹³æ“Š", file: "English-Reading-143.html", icon: "ğŸ¦" },
                    { id: "E144", title: "Orcas", subtitle: "è™é¯¨ï¼šæµ·ä¸­çš„ç‹¼ç¾¤", file: "English-Reading-144.html", icon: "ğŸ‹" },
                    { id: "E145", title: "Pistol Shrimp", subtitle: "æ¯”æ§è²é‚„å¤§è²çš„æ”»æ“Š", file: "English-Reading-145.html", icon: "ğŸ”«" },
                    { id: "E146", title: "Wolves & Rivers", subtitle: "ç‹¼ç¾¤å¦‚ä½•æ”¹è®Šæ²³æµ", file: "English-Reading-146.html", icon: "ğŸº" },
                    { id: "E147", title: "Mimic Octopus", subtitle: "æ“¬æ…‹ç« é­šï¼šå½è£å¤§å¸«", file: "English-Reading-147.html", icon: "ğŸ™" },
                    { id: "E148", title: "Pufferfish", subtitle: "æ²³è±šï¼šè‡´å‘½çš„ç¾å‘³", file: "English-Reading-148.html", icon: "ğŸ¡" },
                    { id: "E149", title: "Electric Eels", subtitle: "é›»é°»ï¼šæ´»ç”Ÿç”Ÿçš„é›»æ± ", file: "English-Reading-149.html", icon: "âš¡" },
                    { id: "E150", title: "The Platypus", subtitle: "é´¨å˜´ç¸ï¼šæœ€æ€ªç•°çš„å‰µé€ ", file: "English-Reading-150.html", icon: "ğŸ¦†" }
                ]
            }
        ];

        /* ================= Firebase åˆå§‹åŒ– ================= */
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
          apiKey: "AIzaSyAxQFt76ZPXE7d0i1XeNZ1yiiD2WYNIfHs",
          authDomain: "chinese-learning-47f4d.firebaseapp.com",
          projectId: "chinese-learning-47f4d",
          storageBucket: "chinese-learning-47f4d.firebasestorage.app",
          messagingSenderId: "76289812052",
          appId: "1:76289812052:web:898384a916f9f341f62fc1"
        };
        
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        // è¨­å®šå°ˆå±¬çš„ App ID ä»¥å€éš”ä¸­æ–‡ç‰ˆè³‡æ–™
        const appId = 'english-learning-hq'; 

        const getPublicRef = (col) => collection(db, 'artifacts', appId, 'public', 'data', col);
        const getUserRef = (uid, col) => collection(db, 'artifacts', appId, 'users', uid, col);

        /* ================= Components ================= */

        // ç‹€æ…‹ç‡ˆè™Ÿ
        const StatusLight = ({ status }) => {
            let dotClass = 'status-loading';
            let text = 'Connecting...';

            if (status === 'success') {
                dotClass = 'status-success';
                text = 'Synced';
            } else if (status === 'error') {
                dotClass = 'status-error';
                text = 'Error';
            } else if (status === 'loading') {
                dotClass = 'status-loading';
                text = 'Loading...';
            } else {
                dotClass = 'status-offline'; 
                text = 'Offline';
            }

            return (
                <div className="flex items-center text-xs text-gray-500 bg-white px-3 py-1 rounded-full shadow-sm border border-gray-100 backdrop-blur-sm bg-opacity-90">
                    <span className={`status-dot ${dotClass}`}></span>
                    {text}
                </div>
            );
        };

        // ç™»å…¥çµ„ä»¶
        const UserLoginWidget = ({ onLogin, usersList }) => {
            const [newUsername, setNewUsername] = useState("");
            const [isCreating, setIsCreating] = useState(false);

            const handleCreate = async () => {
                if (!newUsername.trim()) return;
                setIsCreating(true);
                await onLogin(newUsername.trim(), true);
                setIsCreating(false);
            };

            return (
                <div className="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 max-w-lg w-full mx-auto text-left relative z-10">
                    <h2 className="text-xl font-bold text-gray-700 mb-4 flex items-center gap-2">
                        <span className="text-2xl">ğŸ‘‹</span> Ready to start?
                    </h2>
                    
                    <div className="space-y-2 mb-6 max-h-48 overflow-y-auto pr-2 custom-scrollbar">
                        {usersList.length === 0 ? (
                            <p className="text-center text-gray-400 py-4 text-sm bg-gray-50 rounded-lg">
                                Be the first challenger!
                            </p>
                        ) : (
                            usersList.map((user) => (
                                <button
                                    key={user.uid}
                                    onClick={() => onLogin(user, false)}
                                    className="w-full flex items-center justify-between p-3 rounded-lg hover:bg-indigo-50 border border-transparent hover:border-indigo-200 transition-all text-left group"
                                >
                                    <div className="flex items-center gap-3">
                                        <div className="w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold text-sm">
                                            {user.name.charAt(0).toUpperCase()}
                                        </div>
                                        <span className="font-bold text-gray-700">{user.name}</span>
                                    </div>
                                    <span className="text-xs text-gray-400 group-hover:text-indigo-600">Enter &rarr;</span>
                                </button>
                            ))
                        )}
                    </div>

                    <div className="pt-4 border-t border-gray-100">
                        <label className="text-xs text-gray-400 mb-2 block">Or create new profile</label>
                        <div className="flex gap-2">
                            <input
                                type="text"
                                value={newUsername}
                                onChange={(e) => setNewUsername(e.target.value)}
                                placeholder="Your Name"
                                className="flex-1 px-4 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none"
                                onKeyPress={(e) => e.key === 'Enter' && handleCreate()}
                            />
                            <button
                                onClick={handleCreate}
                                disabled={!newUsername.trim() || isCreating}
                                className="px-4 py-2 bg-indigo-700 text-white text-sm rounded-lg font-bold hover:bg-indigo-800 transition-all disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap"
                            >
                                {isCreating ? 'Creating...' : 'Start'}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // èª²ç¨‹å¡ç‰‡çµ„ä»¶
        const LessonCard = ({ item, theme, isCompleted, onToggle }) => {
            return (
                <div 
                    onClick={onToggle}
                    className={`app-card ${theme} theme-item ${isCompleted ? 'completed' : ''} group select-none`}
                >
                    <div className="absolute top-3 right-3 z-20">
                        <div className="check-circle">
                            {isCompleted && <span className="text-sm font-bold">âœ“</span>}
                        </div>
                    </div>

                    <div className="card-icon group-hover:scale-110 transition-transform duration-300">
                        {item.icon}
                    </div>
                    
                    <div className="card-title text-center text-lg font-bold mb-1 leading-tight">
                        {item.title}
                    </div>
                    <div className="text-center text-sm text-gray-500 mb-3 px-1">
                        {item.subtitle}
                    </div>
                    
                    <div className="card-desc text-xs text-gray-400 bg-gray-50 px-2 py-1 rounded mb-4 font-mono truncate max-w-full">
                        {item.file}
                    </div>

                    <div className={`card-badge rounded-full px-4 py-1 text-xs font-bold tracking-wider text-white mt-auto uppercase ${isCompleted ? '' : 'bg-gray-400'}`}>
                        {isCompleted ? 'Completed' : 'Start Reading'}
                    </div>
                </div>
            );
        };

        // ä¸»ç¨‹å¼
        const App = () => {
            const [user, setUser] = useState(null);
            const [currentProfile, setCurrentProfile] = useState(null);
            const [usersList, setUsersList] = useState([]);
            const [progress, setProgress] = useState({});
            const [status, setStatus] = useState('loading');

            useEffect(() => {
                const initAuth = async () => {
                    try {
                        if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                            await signInWithCustomToken(auth, __initial_auth_token);
                        } else {
                            await signInAnonymously(auth);
                        }
                    } catch (err) {
                        console.error("Auth Error:", err);
                        setStatus('error');
                    }
                };
                initAuth();

                const unsubscribeAuth = onAuthStateChanged(auth, (u) => {
                    if (u) {
                        setUser(u);
                        const listRef = doc(getPublicRef('user_directory'), 'all_users');
                        const unsubList = onSnapshot(listRef, (docSnap) => {
                            if (docSnap.exists()) {
                                setUsersList(docSnap.data().list || []);
                            } else {
                                setUsersList([]);
                            }
                            setStatus('success');
                        }, (err) => {
                            console.error("List Fetch Error:", err);
                            setStatus('error');
                        });
                        return () => unsubList();
                    }
                });

                return () => unsubscribeAuth();
            }, []);

            useEffect(() => {
                if (!user || !currentProfile) return;

                setStatus('loading');
                const progressRef = doc(getUserRef(currentProfile.uid, 'user_progress'), 'main');
                
                const unsubProgress = onSnapshot(progressRef, (docSnap) => {
                    if (docSnap.exists()) {
                        setProgress(docSnap.data().completed || {});
                    } else {
                        setProgress({});
                    }
                    setStatus('success');
                }, (err) => {
                    console.error("Progress Sync Error:", err);
                    setStatus('error');
                });

                return () => unsubProgress();
            }, [user, currentProfile]);

            const handleLogin = async (userDataOrName, isNew) => {
                if (!user) return;

                if (isNew) {
                    const newProfile = {
                        name: userDataOrName,
                        uid: crypto.randomUUID(),
                        createdAt: new Date().toISOString()
                    };
                    const listRef = doc(getPublicRef('user_directory'), 'all_users');
                    try {
                        const docSnap = await getDoc(listRef);
                        if (!docSnap.exists()) {
                            await setDoc(listRef, { list: [newProfile] });
                        } else {
                            await updateDoc(listRef, {
                                list: arrayUnion(newProfile)
                            });
                        }
                        setCurrentProfile(newProfile);
                    } catch (e) {
                        console.error("Create User Error:", e);
                        alert("Login Failed, please try again.");
                    }
                } else {
                    setCurrentProfile(userDataOrName);
                }
            };

            const handleLogout = () => {
                setCurrentProfile(null);
                setProgress({});
            };

            const toggleProgress = async (lessonId) => {
                if (!currentProfile) return;
                
                const newStatus = !progress[lessonId];
                const newProgress = { ...progress, [lessonId]: newStatus };
                setProgress(newProgress);

                try {
                    const progressRef = doc(getUserRef(currentProfile.uid, 'user_progress'), 'main');
                    await setDoc(progressRef, { completed: newProgress }, { merge: true });
                } catch (e) {
                    console.error("Save Progress Error:", e);
                    setStatus('error');
                    setProgress({ ...progress, [lessonId]: !newStatus });
                }
            };

            const totalLessons = ALL_CATEGORIES.reduce((acc, cat) => acc + cat.items.length, 0);
            const completedCount = Object.values(progress).filter(Boolean).length;
            const progressPercentage = Math.round((completedCount / totalLessons) * 100);

            return (
                <div className="flex flex-col items-center min-h-screen pb-20">
                    <header className="w-full max-w-5xl px-6 pt-12 pb-6 text-center relative">
                        <div className="absolute top-4 right-4 flex gap-2">
                            <StatusLight status={status} />
                            {currentProfile && (
                                <button onClick={handleLogout} className="text-xs text-gray-400 hover:text-red-500 bg-white px-3 py-1 rounded-full border border-gray-100 shadow-sm transition-colors">
                                    Logout
                                </button>
                            )}
                        </div>

                        <h1 className="text-4xl md:text-6xl font-black text-gray-800 mb-2 tracking-tight" style={{ fontFamily: 'Poppins' }}>
                            <span className="text-indigo-600">English</span> Learning HQ
                        </h1>
                        <p className="text-gray-500 font-medium uppercase tracking-widest text-sm mb-8">Ultimate Reading Challenge</p>

                        {!currentProfile ? (
                            <div className="mt-8 mb-8">
                                <p className="text-gray-600 text-lg mb-6">Choose your topic, read the story, level up your English.</p>
                                <UserLoginWidget onLogin={handleLogin} usersList={usersList} />
                            </div>
                        ) : (
                            <>
                                <p className="text-gray-600 text-lg font-medium mb-8">
                                    Welcome back, <span className="font-bold text-indigo-700">{currentProfile.name}</span>!
                                </p>

                                <div className="bg-white p-5 rounded-2xl shadow-sm border border-gray-100 mb-10 max-w-xl mx-auto">
                                    <div className="flex justify-between items-end mb-2">
                                        <span className="text-sm font-bold text-gray-500 uppercase tracking-wide">Total Progress</span>
                                        <span className="text-3xl font-black text-indigo-600 font-mono">
                                            {completedCount} <span className="text-sm text-gray-300 font-normal">/ {totalLessons}</span>
                                        </span>
                                    </div>
                                    <div className="w-full bg-gray-100 rounded-full h-4 overflow-hidden">
                                        <div 
                                            className="bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-600 h-full rounded-full transition-all duration-1000 ease-out shadow-lg"
                                            style={{ width: `${progressPercentage}%` }}
                                        ></div>
                                    </div>
                                </div>
                            </>
                        )}
                        
                        <a href="https://nicktsai88.github.io/List/" className="inline-flex items-center gap-2 bg-black text-white px-6 py-2 rounded-full font-bold text-sm hover:scale-105 transition-transform">
                            ğŸ Back to Treasure Box
                        </a>
                    </header>

                    {currentProfile && (
                        <main className="w-full max-w-[1400px] px-4 md:px-8">
                            {ALL_CATEGORIES.map((category, idx) => (
                                <div key={idx} className="mb-12">
                                    <div className={`divider ${category.textClass}`}>{category.title}</div>
                                    <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
                                        {category.items.map((item) => (
                                            <LessonCard 
                                                key={item.id}
                                                item={item}
                                                theme={category.theme}
                                                isCompleted={!!progress[item.id]}
                                                onToggle={() => toggleProgress(item.id)}
                                            />
                                        ))}
                                    </div>
                                </div>
                            ))}
                        </main>
                    )}

                    <footer className="text-center text-gray-300 text-sm mt-12 mb-8">
                        English Learning HQ &copy; {new Date().getFullYear()}
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>